<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Data Pengembalian Barang</h3>
            </div>
            <div class="panel-body">
                <style>
                    #kembaliTable {
                        width: 100% !important;
                    }
                    #kembaliTable td {
                        white-space: normal !important;
                        word-wrap: break-word;
                    }
                    /* Optional: Batasi lebar kolom alasan jika terlalu panjang */
                    #kembaliTable td:nth-child(8) {
                        max-width: 300px;
                    }
                </style>
                <div class="table-responsive">
                    <table id="kembaliTable" class="table table-striped table-bordered table-hover" width="100%">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Kode Distribusi</th>
                                <th>Kode Barang</th>
                                <th>Nama Barang</th>
                                <th>Tanggal Pengajuan</th>
                                <th>Foto</th>
                                <th>Kondisi Barang</th>
                                <th>Alasan Pengembalian</th>
                                <th>Status</th>
                                <th width="10%" class="text-center">Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    var table = $('#kembaliTable').DataTable({
        "responsive": true,
        "processing": true,
        "serverSide": false,
        "ajax": "{?=url([ADMIN, 'asetkami', 'kembaliData'])?}?mode={$mode}",
        "columns": [
            { 
                "data": null, 
                "className": "text-center",
                "render": function (data, type, row, meta) {
                    return meta.row + 1;
                }
            },
            { "data": "kd_distribusi" },
            { "data": "kode_barang" },
            { "data": "nama_barang" },
            { "data": "tanggal", "className": "text-center" },
            { "data": "foto", "orderable": false, "searchable": false, "className": "text-center" },
            { "data": "kondisi" },
            { "data": "alasan" },
            { "data": "status", "orderable": false, "className": "text-center" },
            { "data": "aksi", "orderable": false, "searchable": false, "className": "text-center" }
        ],
        "order": [[ 1, "desc" ]]
    });
});

function verifikasi(id, status) {
    var actionText = status == 'setuju' ? 'menyetujui' : 'menolak';
    if(confirm('Apakah anda yakin ingin ' + actionText + ' pengajuan ini?')) {
        $.post('{?=url([ADMIN, "asetkami", "verifikasiKembali"])?}', {id: id, status: status}, function(response) {
            if(response.status == 'success') {
                $('#kembaliTable').DataTable().ajax.reload();
            } else {
                alert('Gagal memverifikasi');
            }
        }, 'json');
    }
}
</script>

<style>
#kembaliTable {
    font-size: 12px;
}

#kembaliTable th {
    text-align: center;
    background-color: #f5f5f5;
    vertical-align: middle;
}

#kembaliTable td {
    vertical-align: middle;
}

#kembaliTable .btn-group .btn {
    min-width: 50px;
}
</style>
